<div class="event-form-container">
  <div class="header">
    <h1>{{ isEditMode ? 'Edit Event' : 'Create New Event' }}</h1>
    <p class="subtitle">{{ isEditMode ? 'Update event details' : 'Add a new event to your concert hall' }}</p>
  </div>

  <div *ngIf="loading && isEditMode" class="loading-container">
    <mat-spinner diameter="60"></mat-spinner>
    <p>Loading event data...</p>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    <mat-icon>error</mat-icon>
    <span>{{ errorMessage }}</span>
  </div>

  <mat-card *ngIf="!loading || !isEditMode" class="form-card">
    <mat-card-content>
      <form [formGroup]="eventForm" (ngSubmit)="onSubmit()">
        <div class="form-grid">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Event Name</mat-label>
            <input matInput formControlName="name" placeholder="Enter event name" />
            <mat-error *ngIf="eventForm.get('name')?.invalid && eventForm.get('name')?.touched">
              {{ getErrorMessage('name') }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Description</mat-label>
            <textarea
              matInput
              formControlName="description"
              placeholder="Enter event description"
              rows="4"
            ></textarea>
            <mat-error *ngIf="eventForm.get('description')?.invalid && eventForm.get('description')?.touched">
              {{ getErrorMessage('description') }}
            </mat-error>
          </mat-form-field>

          <div class="datetime-row">
            <mat-form-field appearance="outline" class="date-field">
              <mat-label>Event Date</mat-label>
              <input matInput [matDatepicker]="picker" formControlName="eventDateTime" placeholder="Select date" />
              <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
              <mat-error *ngIf="eventForm.get('eventDateTime')?.invalid && eventForm.get('eventDateTime')?.touched">
                {{ getErrorMessage('eventDateTime') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="time-field">
              <mat-label>Event Time</mat-label>
              <input matInput type="time" formControlName="eventTime" placeholder="Select time" />
              <mat-error *ngIf="eventForm.get('eventTime')?.invalid && eventForm.get('eventTime')?.touched">
                {{ getErrorMessage('eventTime') }}
              </mat-error>
            </mat-form-field>
          </div>

          <div class="number-row">
            <mat-form-field appearance="outline">
              <mat-label>Capacity</mat-label>
              <input matInput type="number" formControlName="capacity" placeholder="Enter capacity" />
              <mat-icon matSuffix>people</mat-icon>
              <mat-error *ngIf="eventForm.get('capacity')?.invalid && eventForm.get('capacity')?.touched">
                {{ getErrorMessage('capacity') }}
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Price</mat-label>
              <input matInput type="number" step="0.01" formControlName="price" placeholder="Enter price" />
              <mat-icon matSuffix>attach_money</mat-icon>
              <mat-error *ngIf="eventForm.get('price')?.invalid && eventForm.get('price')?.touched">
                {{ getErrorMessage('price') }}
              </mat-error>
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              <mat-option *ngFor="let status of eventStatuses" [value]="status.value">
                {{ status.label }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="eventForm.get('status')?.invalid && eventForm.get('status')?.touched">
              {{ getErrorMessage('status') }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-actions">
          <button mat-raised-button type="button" (click)="onCancel()" [disabled]="loading">
            Cancel
          </button>
          <button mat-raised-button color="primary" type="submit" [disabled]="loading || eventForm.invalid">
            <mat-spinner *ngIf="loading" diameter="20" class="button-spinner"></mat-spinner>
            <span *ngIf="!loading">{{ isEditMode ? 'Update Event' : 'Create Event' }}</span>
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
